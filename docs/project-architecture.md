# DeepResearchify 项目架构

## 项目架构图

```
+---------------------------+
|      DeepResearchify      |
+---------------------------+
              |
              v
+---------------------------+
|        Next.js App        |
+---------------------------+
              |
     +--------+--------+
     |                 |
     v                 v
+----------+    +--------------+
| 前端组件 |    | API 服务接口 |
+----------+    +--------------+
     |                 |
     v                 v
+----------+    +--------------+
|  UI 渲染  |    | PDF 生成服务 |
+----------+    +--------------+
                      |
                      v
                +--------------+
                |   Puppeteer   |
                +--------------+
```

## 核心组件说明

### 前端层
- **页面组件** (`src/app/page.tsx`): 主页面入口
- **布局组件** (`src/app/layout.tsx`): 全局布局设置
- **文档预览** (`src/app/components/DocumentPreview.tsx`): 文档预览组件
- **Markdown模板** (`src/app/components/MarkdownTemplate.tsx`): Markdown渲染模板

### API服务层
- **PDF生成API** (`src/app/api/generate-pdf/`): 处理PDF生成请求

### 服务层
- **缓存服务** (`src/app/utils/cache.ts`): 提供缓存功能

### 外部依赖
- **Puppeteer/chrome-aws-lambda**: 用于PDF生成
- **Next.js**: 应用框架

## 数据流

1. 用户在前端界面编辑或上传研究内容
2. 前端组件渲染预览
3. 用户请求生成PDF
4. API接收请求并调用PDF生成服务
5. Puppeteer将内容渲染为PDF
6. 返回生成的PDF给用户

## 部署架构

- **Vercel部署**: 项目使用Vercel进行部署
- **函数配置**: PDF生成函数需要特殊的内存和执行时间配置
- **优化策略**: 使用chrome-aws-lambda和缓存机制优化性能

## 开发规范

### 添加新功能时的注意事项

1. **保持架构一致性**: 新功能应遵循现有的架构模式
2. **组件化**: 新UI功能应创建为独立组件
3. **API扩展**: 新的后端功能应通过API路由实现
4. **性能考虑**: 对于资源密集型操作，应考虑缓存和优化

### 代码风格

- 使用TypeScript类型
- 遵循ESLint规则
- 组件使用函数式组件和Hooks

## 架构演进

在添加新功能前，请先查阅此架构文档和开发日志，确保新功能与现有架构保持一致。如需对架构进行重大调整，请更新此文档并在开发日志中记录变更原因。